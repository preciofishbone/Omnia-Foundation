<omf-spinner [spinning]="isLoading">
  <form class="omf-form" ngNoForm>
    <div *ngFor="let roleGroup of roleGroups" class="omf-admin-section-sub">
      <div class="omf-admin-section-sub-content">
        <div *ngFor="let role of roleGroup.children | omfOrderBy:'scope'" class="form-group">
          <label class="omf-form-label">{{role.definition.label | omfLocalize}}</label>
          <div class="omf-form-control">
            <fieldset [disabled]="role.isUseDefaultUsers">
              <omf-csom-people-picker *ngIf="role.scope == 2" 
                                      [isMulti]="true"
                                      [selected]="role.users"
                                      [principalType]="15">
              </omf-csom-people-picker>
              <omf-csom-people-picker *ngIf="role.scope != 2" 
                                      [isMulti]="true"
                                      [selected]="role.users"
                                      [principalType]="0">
              </omf-csom-people-picker>
            </fieldset>
          </div>
          <div [omfShow]="isShowUseDefault(role)" class="omf-form-control">
            <input class="" type="checkbox" [(ngModel)]="role.isUseDefaultUsers" (ngModelChange)="changeUseDefaultUsers(role)" />
            {{role.definition.useDefaultUserText | omfLocalize}}
          </div>
          <div class="omf-form-control omf-admin-permission-description">
            {{role.definition.description | omfLocalize}}
          </div>
        </div>
      </div>
    </div>
    <div class="omf-admin-button-row">
      <button class="btn btn-primary" [disabled]="isSaving" [omfButtonIndicator]="isSaving" (click)="savePermissionRoles()">{{'Buttons.Save' | omfLocalize}}</button>
    </div>
  </form>
</omf-spinner>

